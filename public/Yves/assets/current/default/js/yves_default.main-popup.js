"use strict";
(globalThis["webpackJsonp_yves_default"] = globalThis["webpackJsonp_yves_default"] || []).push([["main-popup"],{

/***/ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/components/molecules/main-popup/main-popup.ts":
/*!*****************************************************************************************************************************!*\
  !*** ./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/components/molecules/main-popup/main-popup.ts ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EVENT_CLOSE_POPUP: () => (/* binding */ EVENT_CLOSE_POPUP),
/* harmony export */   EVENT_OPEN_POPUP: () => (/* binding */ EVENT_OPEN_POPUP),
/* harmony export */   EVENT_POPUP_OPENED: () => (/* binding */ EVENT_POPUP_OPENED),
/* harmony export */   "default": () => (/* binding */ MainPopup)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");
/* harmony import */ var _models_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../models/component */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/models/component.ts");
/* harmony import */ var _app__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../app */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/app/index.ts");
/* harmony import */ var _main_overlay_main_overlay__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../main-overlay/main-overlay */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/components/molecules/main-overlay/main-overlay.ts");




var EVENT_OPEN_POPUP = 'openPopup';
var EVENT_CLOSE_POPUP = 'closePopup';
var EVENT_POPUP_OPENED = 'popupOpened';
class MainPopup extends _models_component__WEBPACK_IMPORTED_MODULE_1__["default"] {
  constructor() {
    super(...arguments);
    this.triggers = void 0;
    this.closeButton = void 0;
    this.overlay = void 0;
    this.cloneTarget = document.body;
    this.clone = void 0;
    this.currentPopup = void 0;
    this.isRootPopup = void 0;
    this.isPopupOpened = false;
    this.showClassName = this.name + "--open";
    this.eventShowOverlay = void 0;
    this.eventHideOverlay = void 0;
  }
  readyCallback() {}
  init() {
    var _this = this;
    return (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      _this.triggers = Array.from(document.getElementsByClassName(_this.triggerClassName));
      _this.overlay = document.getElementsByClassName(_this.overlayClassName)[0];
      _this.isRootPopup = _this.parentElement === _this.cloneTarget;
      yield _this.mapEvents();
      if (_this.isInitiallyOpen) {
        _this.togglePopup(true);
      }
    })();
  }
  mapEvents() {
    var _this2 = this;
    return (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      _this2.mapOpenPopupEvent();
      _this2.mapClosePopupEvent();
      _this2.mapTriggersClickEvent();
      _this2.mapCloseButtonClickEvent();
      if (_this2.overlay) {
        yield (0,_app__WEBPACK_IMPORTED_MODULE_2__.mount)();
        _this2.mapOverlayEvents();
      }
    })();
  }
  mapOpenPopupEvent() {
    this.addEventListener(EVENT_OPEN_POPUP, () => this.onOpenPopup());
  }
  mapClosePopupEvent() {
    this.addEventListener(EVENT_CLOSE_POPUP, () => this.onClosePopup());
  }
  mapTriggersClickEvent() {
    this.triggers.forEach(trigger => {
      trigger.addEventListener('click', () => this.onTriggerClick());
    });
  }
  mapCloseButtonClickEvent(currentPopup) {
    if (currentPopup === void 0) {
      currentPopup = this;
    }
    this.closeButton = currentPopup.getElementsByClassName(this.jsName + "__close")[0];
    this.closeButton.addEventListener('click', () => this.onCloseButtonClick());
  }
  mapOverlayEvents() {
    var overlayConfig = {
      bubbles: true,
      detail: {
        id: this.popupId,
        zIndex: Number(getComputedStyle(this).zIndex) - 1
      }
    };
    this.eventShowOverlay = new CustomEvent(_main_overlay_main_overlay__WEBPACK_IMPORTED_MODULE_3__.EVENT_SHOW_OVERLAY, overlayConfig);
    this.eventHideOverlay = new CustomEvent(_main_overlay_main_overlay__WEBPACK_IMPORTED_MODULE_3__.EVENT_HIDE_OVERLAY, overlayConfig);
    if (this.shouldCloseByOverlayClick) {
      this.mapOverlayClickEvent();
    }
  }
  mapOverlayClickEvent() {
    this.overlay.addEventListener('click', () => this.onOverlayClick());
  }
  onOpenPopup() {
    this.togglePopup(true);
  }
  onClosePopup() {
    this.togglePopup(false);
  }
  onTriggerClick() {
    this.togglePopup();
  }
  onCloseButtonClick() {
    this.togglePopup(false);
  }
  onOverlayClick() {
    this.togglePopup(false);
  }
  togglePopup(forcePopup) {
    if (this.isPopupOpened === forcePopup) {
      return;
    }
    if (!this.currentPopup) {
      this.definePopup();
    }
    this.isPopupOpened = this.currentPopup.classList.toggle(this.showClassName, forcePopup);
    if (!this.isRootPopup && this.hasContentReload) {
      this.reloadContent();
    }
    if (this.overlay) {
      this.toggleOverlay();
    }
    if (this.isPopupOpened) {
      this.dispatchCustomEvent(EVENT_POPUP_OPENED);
    }
  }
  definePopup() {
    if (this.isRootPopup) {
      this.currentPopup = this;
      return;
    }
    this.createClone();
    this.currentPopup = this.clone;
  }
  createClone() {
    this.clone = document.createElement('div');
    this.clone.setAttribute('id', this.popupId);
    this.clone.setAttribute('class', this.getAttribute('class'));
    if (!this.hasContentReload) {
      this.clone.innerHTML = this.innerHTML;
      this.innerHTML = '';
    }
    this.cloneTarget.appendChild(this.clone);
    if (!this.hasContentReload) {
      this.mapCloseButtonClickEvent(this.clone);
    }
    if (this.hasContentMount) {
      (0,_app__WEBPACK_IMPORTED_MODULE_2__.mount)();
    }
  }
  reloadContent() {
    if (this.isPopupOpened) {
      this.clone.innerHTML = this.innerHTML;
      this.innerHTML = '';
      this.mapCloseButtonClickEvent(this.clone);
    }
    if (!this.isPopupOpened) {
      this.innerHTML = this.clone.innerHTML;
      this.clone.innerHTML = '';
    }
    if (this.hasContentMount) {
      (0,_app__WEBPACK_IMPORTED_MODULE_2__.mount)();
    }
  }
  toggleOverlay() {
    if (this.isPopupOpened) {
      this.dispatchEvent(this.eventShowOverlay);
      return;
    }
    this.dispatchEvent(this.eventHideOverlay);
  }
  get popupId() {
    return this.getAttribute('content-id');
  }
  get triggerClassName() {
    return this.getAttribute('trigger-class-name');
  }
  get isInitiallyOpen() {
    return this.hasAttribute('is-open');
  }
  get hasContentMount() {
    return this.hasAttribute('has-content-mount');
  }
  get hasContentReload() {
    return this.hasAttribute('has-content-reload');
  }
  get overlayClassName() {
    return this.getAttribute('overlay-class-name');
  }
  get shouldCloseByOverlayClick() {
    return this.hasAttribute('should-close-by-overlay-click');
  }
}

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjVFLDJDQUFLLENBQUMsQ0FBQztJQUNYO0VBQ0o7RUFFVW9FLGFBQWFBLENBQUEsRUFBUztJQUM1QixJQUFJLElBQUksQ0FBQ2xELGFBQWEsRUFBRTtNQUNwQixJQUFJLENBQUMyRCxhQUFhLENBQUMsSUFBSSxDQUFDeEQsZ0JBQWdCLENBQUM7TUFFekM7SUFDSjtJQUVBLElBQUksQ0FBQ3dELGFBQWEsQ0FBQyxJQUFJLENBQUN2RCxnQkFBZ0IsQ0FBQztFQUM3QztFQUVBLElBQWNnQyxPQUFPQSxDQUFBLEVBQVc7SUFDNUIsT0FBTyxJQUFJLENBQUNtQixZQUFZLENBQUMsWUFBWSxDQUFDO0VBQzFDO0VBRUEsSUFBYzNDLGdCQUFnQkEsQ0FBQSxFQUFXO0lBQ3JDLE9BQU8sSUFBSSxDQUFDMkMsWUFBWSxDQUFDLG9CQUFvQixDQUFDO0VBQ2xEO0VBRUEsSUFBY3ZDLGVBQWVBLENBQUEsRUFBWTtJQUNyQyxPQUFPLElBQUksQ0FBQzRDLFlBQVksQ0FBQyxTQUFTLENBQUM7RUFDdkM7RUFFQSxJQUFjRixlQUFlQSxDQUFBLEVBQVk7SUFDckMsT0FBTyxJQUFJLENBQUNFLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQztFQUNqRDtFQUVBLElBQWNaLGdCQUFnQkEsQ0FBQSxFQUFZO0lBQ3RDLE9BQU8sSUFBSSxDQUFDWSxZQUFZLENBQUMsb0JBQW9CLENBQUM7RUFDbEQ7RUFFQSxJQUFjL0MsZ0JBQWdCQSxDQUFBLEVBQVc7SUFDckMsT0FBTyxJQUFJLENBQUMwQyxZQUFZLENBQUMsb0JBQW9CLENBQUM7RUFDbEQ7RUFFQSxJQUFjZCx5QkFBeUJBLENBQUEsRUFBWTtJQUMvQyxPQUFPLElBQUksQ0FBQ21CLFlBQVksQ0FBQywrQkFBK0IsQ0FBQztFQUM3RDtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3ByeWtlci1iMmMtZGVtby1zaG9wLy4vdmVuZG9yL3NwcnlrZXItc2hvcC9zaG9wLXVpL3NyYy9TcHJ5a2VyU2hvcC9ZdmVzL1Nob3BVaS9UaGVtZS9kZWZhdWx0L2NvbXBvbmVudHMvbW9sZWN1bGVzL21haW4tcG9wdXAvbWFpbi1wb3B1cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uL21vZGVscy9jb21wb25lbnQnO1xuaW1wb3J0IHsgbW91bnQgfSBmcm9tICcuLi8uLi8uLi9hcHAnO1xuaW1wb3J0IHsgRVZFTlRfU0hPV19PVkVSTEFZLCBFVkVOVF9ISURFX09WRVJMQVksIE92ZXJsYXlFdmVudERldGFpbCB9IGZyb20gJy4uL21haW4tb3ZlcmxheS9tYWluLW92ZXJsYXknO1xuXG5leHBvcnQgY29uc3QgRVZFTlRfT1BFTl9QT1BVUCA9ICdvcGVuUG9wdXAnO1xuZXhwb3J0IGNvbnN0IEVWRU5UX0NMT1NFX1BPUFVQID0gJ2Nsb3NlUG9wdXAnO1xuZXhwb3J0IGNvbnN0IEVWRU5UX1BPUFVQX09QRU5FRCA9ICdwb3B1cE9wZW5lZCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1haW5Qb3B1cCBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgcHJvdGVjdGVkIHRyaWdnZXJzOiBIVE1MRWxlbWVudFtdO1xuICAgIHByb3RlY3RlZCBjbG9zZUJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIG92ZXJsYXk6IEhUTUxFbGVtZW50O1xuICAgIHByb3RlY3RlZCBjbG9uZVRhcmdldCA9IGRvY3VtZW50LmJvZHk7XG4gICAgcHJvdGVjdGVkIGNsb25lOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgY3VycmVudFBvcHVwOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgaXNSb290UG9wdXA6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIGlzUG9wdXBPcGVuZWQgPSBmYWxzZTtcbiAgICBwcm90ZWN0ZWQgc2hvd0NsYXNzTmFtZSA9IGAke3RoaXMubmFtZX0tLW9wZW5gO1xuICAgIHByb3RlY3RlZCBldmVudFNob3dPdmVybGF5OiBDdXN0b21FdmVudDxPdmVybGF5RXZlbnREZXRhaWw+O1xuICAgIHByb3RlY3RlZCBldmVudEhpZGVPdmVybGF5OiBDdXN0b21FdmVudDxPdmVybGF5RXZlbnREZXRhaWw+O1xuXG4gICAgcHJvdGVjdGVkIHJlYWR5Q2FsbGJhY2soKTogdm9pZCB7fVxuXG4gICAgcHJvdGVjdGVkIGFzeW5jIGluaXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMudHJpZ2dlcnMgPSA8SFRNTEVsZW1lbnRbXT5BcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy50cmlnZ2VyQ2xhc3NOYW1lKSk7XG4gICAgICAgIHRoaXMub3ZlcmxheSA9IDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMub3ZlcmxheUNsYXNzTmFtZSlbMF07XG4gICAgICAgIHRoaXMuaXNSb290UG9wdXAgPSB0aGlzLnBhcmVudEVsZW1lbnQgPT09IHRoaXMuY2xvbmVUYXJnZXQ7XG5cbiAgICAgICAgYXdhaXQgdGhpcy5tYXBFdmVudHMoKTtcblxuICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxseU9wZW4pIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYXN5bmMgbWFwRXZlbnRzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLm1hcE9wZW5Qb3B1cEV2ZW50KCk7XG4gICAgICAgIHRoaXMubWFwQ2xvc2VQb3B1cEV2ZW50KCk7XG4gICAgICAgIHRoaXMubWFwVHJpZ2dlcnNDbGlja0V2ZW50KCk7XG4gICAgICAgIHRoaXMubWFwQ2xvc2VCdXR0b25DbGlja0V2ZW50KCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3ZlcmxheSkge1xuICAgICAgICAgICAgYXdhaXQgbW91bnQoKTtcbiAgICAgICAgICAgIHRoaXMubWFwT3ZlcmxheUV2ZW50cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG1hcE9wZW5Qb3B1cEV2ZW50KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoRVZFTlRfT1BFTl9QT1BVUCwgKCkgPT4gdGhpcy5vbk9wZW5Qb3B1cCgpKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgbWFwQ2xvc2VQb3B1cEV2ZW50KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoRVZFTlRfQ0xPU0VfUE9QVVAsICgpID0+IHRoaXMub25DbG9zZVBvcHVwKCkpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBtYXBUcmlnZ2Vyc0NsaWNrRXZlbnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudHJpZ2dlcnMuZm9yRWFjaCgodHJpZ2dlcjogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLm9uVHJpZ2dlckNsaWNrKCkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgbWFwQ2xvc2VCdXR0b25DbGlja0V2ZW50KGN1cnJlbnRQb3B1cDogSFRNTEVsZW1lbnQgPSB0aGlzKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2xvc2VCdXR0b24gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+Y3VycmVudFBvcHVwLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYCR7dGhpcy5qc05hbWV9X19jbG9zZWApWzBdO1xuICAgICAgICB0aGlzLmNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5vbkNsb3NlQnV0dG9uQ2xpY2soKSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG1hcE92ZXJsYXlFdmVudHMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG92ZXJsYXlDb25maWc6IEN1c3RvbUV2ZW50SW5pdDxPdmVybGF5RXZlbnREZXRhaWw+ID0ge1xuICAgICAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIGlkOiB0aGlzLnBvcHVwSWQsXG4gICAgICAgICAgICAgICAgekluZGV4OiBOdW1iZXIoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzKS56SW5kZXgpIC0gMSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5ldmVudFNob3dPdmVybGF5ID0gbmV3IEN1c3RvbUV2ZW50KEVWRU5UX1NIT1dfT1ZFUkxBWSwgb3ZlcmxheUNvbmZpZyk7XG4gICAgICAgIHRoaXMuZXZlbnRIaWRlT3ZlcmxheSA9IG5ldyBDdXN0b21FdmVudChFVkVOVF9ISURFX09WRVJMQVksIG92ZXJsYXlDb25maWcpO1xuXG4gICAgICAgIGlmICh0aGlzLnNob3VsZENsb3NlQnlPdmVybGF5Q2xpY2spIHtcbiAgICAgICAgICAgIHRoaXMubWFwT3ZlcmxheUNsaWNrRXZlbnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBtYXBPdmVybGF5Q2xpY2tFdmVudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5vbk92ZXJsYXlDbGljaygpKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgb25PcGVuUG9wdXAoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAodHJ1ZSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9uQ2xvc2VQb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9uVHJpZ2dlckNsaWNrKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9uQ2xvc2VCdXR0b25DbGljaygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9uT3ZlcmxheUNsaWNrKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdG9nZ2xlUG9wdXAoZm9yY2VQb3B1cD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW5lZCA9PT0gZm9yY2VQb3B1cCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRQb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5kZWZpbmVQb3B1cCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pc1BvcHVwT3BlbmVkID0gdGhpcy5jdXJyZW50UG9wdXAuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLnNob3dDbGFzc05hbWUsIGZvcmNlUG9wdXApO1xuXG4gICAgICAgIGlmICghdGhpcy5pc1Jvb3RQb3B1cCAmJiB0aGlzLmhhc0NvbnRlbnRSZWxvYWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVsb2FkQ29udGVudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3ZlcmxheSkge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pc1BvcHVwT3BlbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoQ3VzdG9tRXZlbnQoRVZFTlRfUE9QVVBfT1BFTkVEKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBkZWZpbmVQb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSb290UG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBvcHVwID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jcmVhdGVDbG9uZSgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRQb3B1cCA9IHRoaXMuY2xvbmU7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUNsb25lKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNsb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuY2xvbmUuc2V0QXR0cmlidXRlKCdpZCcsIHRoaXMucG9wdXBJZCk7XG4gICAgICAgIHRoaXMuY2xvbmUuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRoaXMuZ2V0QXR0cmlidXRlKCdjbGFzcycpKTtcblxuICAgICAgICBpZiAoIXRoaXMuaGFzQ29udGVudFJlbG9hZCkge1xuICAgICAgICAgICAgdGhpcy5jbG9uZS5pbm5lckhUTUwgPSB0aGlzLmlubmVySFRNTDtcbiAgICAgICAgICAgIHRoaXMuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNsb25lVGFyZ2V0LmFwcGVuZENoaWxkKHRoaXMuY2xvbmUpO1xuXG4gICAgICAgIGlmICghdGhpcy5oYXNDb250ZW50UmVsb2FkKSB7XG4gICAgICAgICAgICB0aGlzLm1hcENsb3NlQnV0dG9uQ2xpY2tFdmVudCh0aGlzLmNsb25lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhhc0NvbnRlbnRNb3VudCkge1xuICAgICAgICAgICAgbW91bnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCByZWxvYWRDb250ZW50KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc1BvcHVwT3BlbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmNsb25lLmlubmVySFRNTCA9IHRoaXMuaW5uZXJIVE1MO1xuICAgICAgICAgICAgdGhpcy5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIHRoaXMubWFwQ2xvc2VCdXR0b25DbGlja0V2ZW50KHRoaXMuY2xvbmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzUG9wdXBPcGVuZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaW5uZXJIVE1MID0gdGhpcy5jbG9uZS5pbm5lckhUTUw7XG4gICAgICAgICAgICB0aGlzLmNsb25lLmlubmVySFRNTCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaGFzQ29udGVudE1vdW50KSB7XG4gICAgICAgICAgICBtb3VudCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHRvZ2dsZU92ZXJsYXkoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLmV2ZW50U2hvd092ZXJsYXkpO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5ldmVudEhpZGVPdmVybGF5KTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0IHBvcHVwSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdjb250ZW50LWlkJyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCB0cmlnZ2VyQ2xhc3NOYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZSgndHJpZ2dlci1jbGFzcy1uYW1lJyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCBpc0luaXRpYWxseU9wZW4oKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0F0dHJpYnV0ZSgnaXMtb3BlbicpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgaGFzQ29udGVudE1vdW50KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoJ2hhcy1jb250ZW50LW1vdW50Jyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCBoYXNDb250ZW50UmVsb2FkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoJ2hhcy1jb250ZW50LXJlbG9hZCcpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgb3ZlcmxheUNsYXNzTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ292ZXJsYXktY2xhc3MtbmFtZScpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgc2hvdWxkQ2xvc2VCeU92ZXJsYXlDbGljaygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlKCdzaG91bGQtY2xvc2UtYnktb3ZlcmxheS1jbGljaycpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJtb3VudCIsIkVWRU5UX1NIT1dfT1ZFUkxBWSIsIkVWRU5UX0hJREVfT1ZFUkxBWSIsIkVWRU5UX09QRU5fUE9QVVAiLCJFVkVOVF9DTE9TRV9QT1BVUCIsIkVWRU5UX1BPUFVQX09QRU5FRCIsIk1haW5Qb3B1cCIsImNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwidHJpZ2dlcnMiLCJjbG9zZUJ1dHRvbiIsIm92ZXJsYXkiLCJjbG9uZVRhcmdldCIsImRvY3VtZW50IiwiYm9keSIsImNsb25lIiwiY3VycmVudFBvcHVwIiwiaXNSb290UG9wdXAiLCJpc1BvcHVwT3BlbmVkIiwic2hvd0NsYXNzTmFtZSIsIm5hbWUiLCJldmVudFNob3dPdmVybGF5IiwiZXZlbnRIaWRlT3ZlcmxheSIsInJlYWR5Q2FsbGJhY2siLCJpbml0IiwiX3RoaXMiLCJfYXN5bmNUb0dlbmVyYXRvciIsIkFycmF5IiwiZnJvbSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJ0cmlnZ2VyQ2xhc3NOYW1lIiwib3ZlcmxheUNsYXNzTmFtZSIsInBhcmVudEVsZW1lbnQiLCJtYXBFdmVudHMiLCJpc0luaXRpYWxseU9wZW4iLCJ0b2dnbGVQb3B1cCIsIl90aGlzMiIsIm1hcE9wZW5Qb3B1cEV2ZW50IiwibWFwQ2xvc2VQb3B1cEV2ZW50IiwibWFwVHJpZ2dlcnNDbGlja0V2ZW50IiwibWFwQ2xvc2VCdXR0b25DbGlja0V2ZW50IiwibWFwT3ZlcmxheUV2ZW50cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbk9wZW5Qb3B1cCIsIm9uQ2xvc2VQb3B1cCIsImZvckVhY2giLCJ0cmlnZ2VyIiwib25UcmlnZ2VyQ2xpY2siLCJqc05hbWUiLCJvbkNsb3NlQnV0dG9uQ2xpY2siLCJvdmVybGF5Q29uZmlnIiwiYnViYmxlcyIsImRldGFpbCIsImlkIiwicG9wdXBJZCIsInpJbmRleCIsIk51bWJlciIsImdldENvbXB1dGVkU3R5bGUiLCJDdXN0b21FdmVudCIsInNob3VsZENsb3NlQnlPdmVybGF5Q2xpY2siLCJtYXBPdmVybGF5Q2xpY2tFdmVudCIsIm9uT3ZlcmxheUNsaWNrIiwiZm9yY2VQb3B1cCIsImRlZmluZVBvcHVwIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiaGFzQ29udGVudFJlbG9hZCIsInJlbG9hZENvbnRlbnQiLCJ0b2dnbGVPdmVybGF5IiwiZGlzcGF0Y2hDdXN0b21FdmVudCIsImNyZWF0ZUNsb25lIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiaGFzQ29udGVudE1vdW50IiwiZGlzcGF0Y2hFdmVudCIsImhhc0F0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=